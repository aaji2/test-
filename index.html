<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Canvas - Creative Workspace Suite</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="Complete creative workspace suite - Web design, image editing, video editing, screen recording, and productivity tools">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/icon-192.png">
    <link rel="apple-touch-icon" href="assets/icon-192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/studios.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="logo">
                <h1>Nexus Canvas</h1>
                <p>Creative Workspace Suite</p>
            </div>
            <div class="loading-spinner"></div>
            <p class="loading-text">Initializing workspace...</p>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app hidden">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="nav-left">
                <div class="logo-small">
                    <span class="logo-icon">üé®</span>
                    <span class="logo-text">Nexus Canvas</span>
                </div>
            </div>
            
            <div class="nav-center">
                <div class="studio-tabs">
                    <button class="studio-tab active" data-studio="web-creator">
                        <span class="tab-icon">üåê</span>
                        <span class="tab-text">Web Creator</span>
                    </button>
                    <button class="studio-tab" data-studio="code-editor">
                        <span class="tab-icon">üíª</span>
                        <span class="tab-text">Code Studio</span>
                    </button>
                    <button class="studio-tab" data-studio="image-editor">
                        <span class="tab-icon">üñºÔ∏è</span>
                        <span class="tab-text">Image Studio</span>
                    </button>
                    <button class="studio-tab" data-studio="video-editor">
                        <span class="tab-icon">üé¨</span>
                        <span class="tab-text">Video Studio</span>
                    </button>
                    <button class="studio-tab" data-studio="screen-recorder">
                        <span class="tab-icon">üìπ</span>
                        <span class="tab-text">Screen Recorder</span>
                    </button>
                    <button class="studio-tab" data-studio="productivity">
                        <span class="tab-icon">üìä</span>
                        <span class="tab-text">Productivity</span>
                    </button>
                </div>
            </div>
            
            <div class="nav-right">
                <button class="nav-btn" id="theme-toggle" title="Toggle Theme">
                    <span class="icon">üåô</span>
                </button>
                <button class="nav-btn" id="settings-btn" title="Settings">
                    <span class="icon">‚öôÔ∏è</span>
                </button>
                <button class="nav-btn" id="help-btn" title="Help">
                    <span class="icon">‚ùì</span>
                </button>
            </div>
        </nav>

        <!-- Studio Container -->
        <main class="studio-container">
            <!-- Web Content Creator Studio -->
            <div id="web-creator-studio" class="studio active">
                <div class="studio-layout">
                    <!-- Left Sidebar - Components -->
                    <div class="left-sidebar">
                        <div class="sidebar-header">
                            <h3>Components</h3>
                        </div>
                        <div class="component-library">
                            <div class="component-category">
                                <h4>Layout</h4>
                                <div class="component-item" draggable="true" data-component="container">
                                    <span class="component-icon">üì¶</span>
                                    <span class="component-name">Container</span>
                                </div>
                                <div class="component-item" draggable="true" data-component="section">
                                    <span class="component-icon">üìÑ</span>
                                    <span class="component-name">Section</span>
                                </div>
                                <div class="component-item" draggable="true" data-component="grid">
                                    <span class="component-icon">‚öè</span>
                                    <span class="component-name">Grid</span>
                                </div>
                            </div>
                            <div class="component-category">
                                <h4>Content</h4>
                                <div class="component-item" draggable="true" data-component="text">
                                    <span class="component-icon">üìù</span>
                                    <span class="component-name">Text</span>
                                </div>
                                <div class="component-item" draggable="true" data-component="heading">
                                    <span class="component-icon">üì∞</span>
                                    <span class="component-name">Heading</span>
                                </div>
                                <div class="component-item" draggable="true" data-component="image">
                                    <span class="component-icon">üñºÔ∏è</span>
                                    <span class="component-name">Image</span>
                                </div>
                                <div class="component-item" draggable="true" data-component="button">
                                    <span class="component-icon">üîò</span>
                                    <span class="component-name">Button</span>
                                </div>
                            </div>
                            <div class="component-category">
                                <h4>Navigation</h4>
                                <div class="component-item" draggable="true" data-component="navbar">
                                    <span class="component-icon">üß≠</span>
                                    <span class="component-name">Navbar</span>
                                </div>
                                <div class="component-item" draggable="true" data-component="menu">
                                    <span class="component-icon">‚ò∞</span>
                                    <span class="component-name">Menu</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Canvas Area -->
                    <div class="main-canvas">
                        <div class="canvas-toolbar">
                            <div class="device-preview">
                                <button class="device-btn active" data-device="desktop">
                                    <span class="icon">üñ•Ô∏è</span>
                                    <span class="text">Desktop</span>
                                </button>
                                <button class="device-btn" data-device="tablet">
                                    <span class="icon">üì±</span>
                                    <span class="text">Tablet</span>
                                </button>
                                <button class="device-btn" data-device="mobile">
                                    <span class="icon">üì±</span>
                                    <span class="text">Mobile</span>
                                </button>
                            </div>
                            <div class="canvas-actions">
                                <button class="action-btn" id="preview-btn">
                                    <span class="icon">üëÅÔ∏è</span>
                                    <span class="text">Preview</span>
                                </button>
                                <button class="action-btn" id="export-btn">
                                    <span class="icon">üíæ</span>
                                    <span class="text">Export</span>
                                </button>
                            </div>
                        </div>
                        <div class="canvas-wrapper">
                            <div id="design-canvas" class="design-canvas" data-device="desktop">
                                <div class="canvas-content">
                                    <!-- Dynamic content will be added here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Sidebar - Properties -->
                    <div class="right-sidebar">
                        <div class="sidebar-header">
                            <h3>Properties</h3>
                        </div>
                        <div id="properties-panel" class="properties-panel">
                            <div class="no-selection">
                                <p>Select an element to edit its properties</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Code Editor Studio -->
            <div id="code-editor-studio" class="studio">
                <div class="studio-layout">
                    <!-- File Explorer -->
                    <div class="left-sidebar">
                        <div class="sidebar-header">
                            <h3>Files</h3>
                            <button class="add-file-btn" id="add-file">+</button>
                        </div>
                        <div id="file-explorer" class="file-explorer">
                            <!-- File tree will be populated here -->
                        </div>
                    </div>

                    <!-- Code Editor -->
                    <div class="main-editor">
                        <div class="editor-tabs">
                            <!-- Editor tabs will be added here -->
                        </div>
                        <div class="editor-container">
                            <div id="code-editor" class="code-editor">
                                <div class="editor-placeholder">
                                    <h3>Welcome to Code Studio</h3>
                                    <p>Create or open a file to start coding</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Live Preview -->
                    <div class="right-sidebar">
                        <div class="sidebar-header">
                            <h3>Live Preview</h3>
                            <button class="refresh-btn" id="refresh-preview">üîÑ</button>
                        </div>
                        <div class="preview-container">
                            <iframe id="live-preview" class="live-preview"></iframe>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Image Editor Studio -->
            <div id="image-editor-studio" class="studio">
                <div class="studio-layout">
                    <!-- Tools Sidebar -->
                    <div class="left-sidebar">
                        <div class="sidebar-header">
                            <h3>Tools</h3>
                        </div>
                        <div class="tools-panel">
                            <div class="tool-group">
                                <h4>Selection</h4>
                                <button class="tool-btn active" data-tool="select">
                                    <span class="icon">üî≤</span>
                                    <span class="text">Select</span>
                                </button>
                                <button class="tool-btn" data-tool="crop">
                                    <span class="icon">‚úÇÔ∏è</span>
                                    <span class="text">Crop</span>
                                </button>
                            </div>
                            <div class="tool-group">
                                <h4>Drawing</h4>
                                <button class="tool-btn" data-tool="brush">
                                    <span class="icon">üñåÔ∏è</span>
                                    <span class="text">Brush</span>
                                </button>
                                <button class="tool-btn" data-tool="eraser">
                                    <span class="icon">üßΩ</span>
                                    <span class="text">Eraser</span>
                                </button>
                                <button class="tool-btn" data-tool="text">
                                    <span class="icon">üìù</span>
                                    <span class="text">Text</span>
                                </button>
                            </div>
                            <div class="tool-group">
                                <h4>Shapes</h4>
                                <button class="tool-btn" data-tool="rectangle">
                                    <span class="icon">‚¨ú</span>
                                    <span class="text">Rectangle</span>
                                </button>
                                <button class="tool-btn" data-tool="circle">
                                    <span class="icon">‚≠ï</span>
                                    <span class="text">Circle</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Main Canvas -->
                    <div class="main-canvas">
                        <div class="canvas-toolbar">
                            <div class="file-actions">
                                <button class="action-btn" id="open-image">
                                    <span class="icon">üìÅ</span>
                                    <span class="text">Open</span>
                                </button>
                                <button class="action-btn" id="save-image">
                                    <span class="icon">üíæ</span>
                                    <span class="text">Save</span>
                                </button>
                            </div>
                            <div class="zoom-controls">
                                <button class="zoom-btn" id="zoom-out">-</button>
                                <span class="zoom-level">100%</span>
                                <button class="zoom-btn" id="zoom-in">+</button>
                            </div>
                        </div>
                        <div class="canvas-wrapper">
                            <canvas id="image-canvas" class="image-canvas"></canvas>
                            <div class="canvas-overlay">
                                <!-- Selection handles and overlays -->
                            </div>
                        </div>
                    </div>

                    <!-- Properties & Layers -->
                    <div class="right-sidebar">
                        <div class="sidebar-section">
                            <div class="sidebar-header">
                                <h3>Layers</h3>
                                <button class="add-layer-btn" id="add-layer">+</button>
                            </div>
                            <div id="layers-panel" class="layers-panel">
                                <!-- Layers will be added here -->
                            </div>
                        </div>
                        <div class="sidebar-section">
                            <div class="sidebar-header">
                                <h3>Adjustments</h3>
                            </div>
                            <div class="adjustments-panel">
                                <div class="adjustment-group">
                                    <label>Brightness</label>
                                    <input type="range" id="brightness" min="-100" max="100" value="0">
                                </div>
                                <div class="adjustment-group">
                                    <label>Contrast</label>
                                    <input type="range" id="contrast" min="-100" max="100" value="0">
                                </div>
                                <div class="adjustment-group">
                                    <label>Saturation</label>
                                    <input type="range" id="saturation" min="-100" max="100" value="0">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Video Editor Studio -->
            <div id="video-editor-studio" class="studio">
                <div class="studio-layout">
                    <!-- Media Library -->
                    <div class="left-sidebar">
                        <div class="sidebar-header">
                            <h3>Media Library</h3>
                            <button class="import-btn" id="import-media">Import</button>
                        </div>
                        <div id="media-library" class="media-library">
                            <!-- Media items will be added here -->
                        </div>
                    </div>

                    <!-- Main Timeline -->
                    <div class="main-timeline">
                        <div class="preview-area">
                            <video id="video-preview" class="video-preview" controls></video>
                            <div class="preview-controls">
                                <button class="control-btn" id="play-pause">‚ñ∂Ô∏è</button>
                                <button class="control-btn" id="stop">‚èπÔ∏è</button>
                                <span class="timecode">00:00:00</span>
                            </div>
                        </div>
                        <div class="timeline-area">
                            <div class="timeline-header">
                                <div class="track-labels">
                                    <div class="track-label">Video 1</div>
                                    <div class="track-label">Audio 1</div>
                                </div>
                                <div class="timeline-ruler">
                                    <!-- Timeline ruler will be generated -->
                                </div>
                            </div>
                            <div class="timeline-tracks">
                                <div class="track video-track" data-track="video1">
                                    <!-- Video clips will be added here -->
                                </div>
                                <div class="track audio-track" data-track="audio1">
                                    <!-- Audio clips will be added here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Effects & Properties -->
                    <div class="right-sidebar">
                        <div class="sidebar-section">
                            <div class="sidebar-header">
                                <h3>Effects</h3>
                            </div>
                            <div class="effects-panel">
                                <div class="effect-category">
                                    <h4>Color</h4>
                                    <div class="effect-item" data-effect="brightness">Brightness</div>
                                    <div class="effect-item" data-effect="contrast">Contrast</div>
                                    <div class="effect-item" data-effect="saturation">Saturation</div>
                                </div>
                                <div class="effect-category">
                                    <h4>Blur</h4>
                                    <div class="effect-item" data-effect="blur">Gaussian Blur</div>
                                    <div class="effect-item" data-effect="motion-blur">Motion Blur</div>
                                </div>
                            </div>
                        </div>
                        <div class="sidebar-section">
                            <div class="sidebar-header">
                                <h3>Export</h3>
                            </div>
                            <div class="export-panel">
                                <div class="export-settings">
                                    <label>Format</label>
                                    <select id="export-format">
                                        <option value="mp4">MP4</option>
                                        <option value="webm">WebM</option>
                                    </select>
                                    <label>Quality</label>
                                    <select id="export-quality">
                                        <option value="high">High</option>
                                        <option value="medium">Medium</option>
                                        <option value="low">Low</option>
                                    </select>
                                </div>
                                <button class="export-btn" id="export-video">Export Video</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Screen Recorder Studio -->
            <div id="screen-recorder-studio" class="studio">
                <div class="studio-layout">
                    <div class="recorder-main">
                        <div class="recorder-header">
                            <h2>Screen Recorder</h2>
                            <div class="recording-status">
                                <span class="status-indicator" id="recording-indicator"></span>
                                <span class="status-text" id="recording-status">Ready to Record</span>
                            </div>
                        </div>

                        <div class="recorder-preview">
                            <video id="screen-preview" class="screen-preview" autoplay muted></video>
                            <div class="preview-overlay">
                                <div class="recording-timer" id="recording-timer">00:00:00</div>
                            </div>
                        </div>

                        <div class="recorder-controls">
                            <div class="source-selection">
                                <h3>Recording Source</h3>
                                <div class="source-options">
                                    <button class="source-btn active" data-source="screen">
                                        <span class="icon">üñ•Ô∏è</span>
                                        <span class="text">Screen</span>
                                    </button>
                                    <button class="source-btn" data-source="window">
                                        <span class="icon">ü™ü</span>
                                        <span class="text">Window</span>
                                    </button>
                                    <button class="source-btn" data-source="tab">
                                        <span class="icon">üóÇÔ∏è</span>
                                        <span class="text">Tab</span>
                                    </button>
                                </div>
                            </div>

                            <div class="audio-settings">
                                <h3>Audio Settings</h3>
                                <div class="audio-options">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="system-audio" checked>
                                        <span class="checkmark"></span>
                                        System Audio
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="microphone-audio">
                                        <span class="checkmark"></span>
                                        Microphone
                                    </label>
                                </div>
                            </div>

                            <div class="recording-settings">
                                <h3>Recording Settings</h3>
                                <div class="settings-grid">
                                    <div class="setting-group">
                                        <label>Resolution</label>
                                        <select id="recording-resolution">
                                            <option value="1920x1080">1920x1080 (Full HD)</option>
                                            <option value="1280x720">1280x720 (HD)</option>
                                            <option value="854x480">854x480 (SD)</option>
                                        </select>
                                    </div>
                                    <div class="setting-group">
                                        <label>Frame Rate</label>
                                        <select id="recording-framerate">
                                            <option value="60">60 FPS</option>
                                            <option value="30" selected>30 FPS</option>
                                            <option value="24">24 FPS</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="record-actions">
                                <button class="record-btn" id="start-recording">
                                    <span class="icon">üî¥</span>
                                    <span class="text">Start Recording</span>
                                </button>
                                <button class="record-btn" id="pause-recording" disabled>
                                    <span class="icon">‚è∏Ô∏è</span>
                                    <span class="text">Pause</span>
                                </button>
                                <button class="record-btn" id="stop-recording" disabled>
                                    <span class="icon">‚èπÔ∏è</span>
                                    <span class="text">Stop</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="recordings-sidebar">
                        <div class="sidebar-header">
                            <h3>Recordings</h3>
                        </div>
                        <div id="recordings-list" class="recordings-list">
                            <!-- Recorded videos will be listed here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Productivity Studio -->
            <div id="productivity-studio" class="studio">
                <div class="studio-layout">
                    <div class="productivity-nav">
                        <button class="productivity-tab active" data-app="document">
                            <span class="icon">üìÑ</span>
                            <span class="text">Document</span>
                        </button>
                        <button class="productivity-tab" data-app="spreadsheet">
                            <span class="icon">üìä</span>
                            <span class="text">Spreadsheet</span>
                        </button>
                        <button class="productivity-tab" data-app="presentation">
                            <span class="icon">üìΩÔ∏è</span>
                            <span class="text">Presentation</span>
                        </button>
                    </div>

                    <!-- Document Editor -->
                    <div id="document-app" class="productivity-app active">
                        <div class="document-toolbar">
                            <div class="toolbar-group">
                                <button class="toolbar-btn" data-action="bold">
                                    <span class="icon">B</span>
                                </button>
                                <button class="toolbar-btn" data-action="italic">
                                    <span class="icon">I</span>
                                </button>
                                <button class="toolbar-btn" data-action="underline">
                                    <span class="icon">U</span>
                                </button>
                            </div>
                            <div class="toolbar-group">
                                <select class="font-select" id="font-family">
                                    <option value="Noto Sans JP">Noto Sans JP</option>
                                    <option value="Inter">Inter</option>
                                    <option value="Arial">Arial</option>
                                </select>
                                <select class="font-size-select" id="font-size">
                                    <option value="12">12</option>
                                    <option value="14" selected>14</option>
                                    <option value="16">16</option>
                                    <option value="18">18</option>
                                    <option value="24">24</option>
                                </select>
                            </div>
                            <div class="toolbar-group">
                                <button class="toolbar-btn" data-action="alignLeft">
                                    <span class="icon">‚¨ÖÔ∏è</span>
                                </button>
                                <button class="toolbar-btn" data-action="alignCenter">
                                    <span class="icon">‚ÜîÔ∏è</span>
                                </button>
                                <button class="toolbar-btn" data-action="alignRight">
                                    <span class="icon">‚û°Ô∏è</span>
                                </button>
                            </div>
                        </div>
                        <div class="document-editor">
                            <div id="document-content" class="document-content" contenteditable="true">
                                <h1>Document Title</h1>
                                <p>Start typing your document here...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Spreadsheet Editor -->
                    <div id="spreadsheet-app" class="productivity-app">
                        <div class="spreadsheet-toolbar">
                            <div class="toolbar-group">
                                <button class="toolbar-btn" id="add-row">Add Row</button>
                                <button class="toolbar-btn" id="add-column">Add Column</button>
                            </div>
                            <div class="toolbar-group">
                                <input type="text" id="formula-bar" class="formula-bar" placeholder="Enter formula...">
                            </div>
                        </div>
                        <div class="spreadsheet-container">
                            <table id="spreadsheet-table" class="spreadsheet-table">
                                <!-- Spreadsheet will be generated here -->
                            </table>
                        </div>
                    </div>

                    <!-- Presentation Editor -->
                    <div id="presentation-app" class="productivity-app">
                        <div class="presentation-layout">
                            <div class="slides-panel">
                                <div class="slides-header">
                                    <h3>Slides</h3>
                                    <button class="add-slide-btn" id="add-slide">+</button>
                                </div>
                                <div id="slides-list" class="slides-list">
                                    <!-- Slide thumbnails will be added here -->
                                </div>
                            </div>
                            <div class="slide-editor">
                                <div class="slide-toolbar">
                                    <div class="toolbar-group">
                                        <button class="toolbar-btn" data-element="text">
                                            <span class="icon">üìù</span>
                                            <span class="text">Text</span>
                                        </button>
                                        <button class="toolbar-btn" data-element="image">
                                            <span class="icon">üñºÔ∏è</span>
                                            <span class="text">Image</span>
                                        </button>
                                        <button class="toolbar-btn" data-element="shape">
                                            <span class="icon">üî∑</span>
                                            <span class="text">Shape</span>
                                        </button>
                                    </div>
                                </div>
                                <div id="slide-canvas" class="slide-canvas">
                                    <!-- Current slide content -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals and Overlays -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title"></h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-content">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="scripts/core/app.js" type="module"></script>
    <script src="scripts/core/storage.js" type="module"></script>
    <script src="scripts/core/utils.js" type="module"></script>
    <script src="scripts/studios/web-creator.js" type="module"></script>
    <script src="scripts/studios/code-editor.js" type="module"></script>
    <script src="scripts/studios/image-editor.js" type="module"></script>
    <script src="scripts/studios/video-editor.js" type="module"></script>
    <script src="scripts/studios/screen-recorder.js" type="module"></script>
    <script src="scripts/studios/productivity.js" type="module"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>